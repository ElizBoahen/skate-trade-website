/*!CK:2571123284!*//*1438591244,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["LfzUa"]); }

__d("ReactComposerPhotoLegacyLimitExceededDialog",["Dialog","fbt"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i={show:function(j){var k=h._("Too Many Photos"),l=h._("Sorry, you can only add {maxselect} photos to a message. If you'd like, you can add photos to additional messages.",[h.param("maxselect",j)]);new g().setTitle(k).setBody(l).setButtons(g.OK).setModal(true).show();}};e.exports=i;},null);
__d("ReactComposerVideoLegacyLimitExceededDialog",["ErrorDialog","fbt"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i={show:function(){g.show(h._("Too many files"),h._("Please select only one video file at a time."));}};e.exports=i;},null);
__d("ReactComposerVideoUploadActions",["ReactComposerDispatcher","ReactComposerVideoUploadActionType","ReactComposerVideoUploadStore"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();b('ReactComposerVideoUploadStore');var i={setUploader:function(j,k){g.dispatch({composerID:j,type:h.VIDEO_SET_UPLOADER,uploader:k});},add:function(j,k){g.dispatch({composerID:j,type:h.VIDEO_UPLOAD_ADD,file:k});},remove:function(j){g.dispatch({composerID:j,type:h.VIDEO_UPLOAD_REMOVE});}};e.exports=i;},null);
__d("ReactComposerMediaUtils",["ReactComposerPhotoActions","ReactComposerPhotoLegacyLimitExceededDialog","ReactComposerPhotoUploadActions","ReactComposerPhotoUploadStore","ReactComposerVideoLegacyLimitExceededDialog","ReactComposerVideoUploadStore","ReactComposerVideoUploadActions","VideoUploadFeatureDetector","VideoUploadConfig","VideoUploadFile","Map","PUWMethods","uniqueID"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.__markCompiled&&b.__markCompiled();var t={clearInput:function(u){var v=this.getFileNamesFromFileInput(u.getInput());if(!t.hasVideos(v))u.clear();},getFileNames:function(u){var v=[];for(var w=0;w<u.length;w++)v.push(u[w].name);return v;},getFileNamesFromFileInput:function(u){if(n.supportsFileAPI()){return this.getFileNames(u.files);}else return [u.value.split('/').pop().split('\\').pop()];},hasVideos:function(u){if(o.allowMultimedia)return false;var v=0;u.forEach(function(w){var x=w.indexOf('.')!==-1?w.split('.').pop().toLowerCase():'';if(!!o.videoExtensions[x])v++;});return v>0;},uploadVideo:function(u,v){if(j.getUploads(u).size>0)i.removeAllPhotoUploads(u);m.add(u,v);},uploadPhotos:function(u,v,w,x,y,z){var aa=w.isUploadLimitExceeded(x,v);if(aa){h.show(w.getMaxSelectableFilesCount(x));return;}var ba=v&&v.length;if(!ba||ba<1)return;if(l.getVideo(u))m.remove(u);i.photosSelect(u,ba,y);z&&z();},uploadPhotosOrVideoFromTarget:function(u,v,w,x){var y=this.getFileNamesFromFileInput(v);if(this.hasVideos(y)){if(v.files&&v.files.length>1){k.show();}else this.uploadVideo(u,p.fromFileInput(v));}else this.uploadPhotos(u,v.files,w,x,r.FILE_SELECTOR,function(){w&&w.upload(v);});},uploadPhotosOrVideo:function(u,v,w,x){var y=this.getFileNames(v);if(this.hasVideos(y)){if(v&&v.length>1){k.show();}else this.uploadVideo(u,p.fromFile(v[0]));}else this.uploadPhotos(u,v,w,x,r.DRAGDROP,function(){v.forEach(function(z){z.uploadID=s();z.filename='';});w.enqueueAsyncUploadRequest(u,v,{});});},onImageEdited:function(u,v,w,x){var y=j.getUploads(u),z=y.find(function(da){return da.photoID===x.fbid||da.originalPhotoID===x.fbid;}),aa=j.getUploadIndex(u,z.id);g.removePhoto(u,z.photoID,z.id);var ba=x.blob;ba.uploadID=s();ba.filename=z.filename;var ca=new q([[ba.uploadID,aa]]);v&&v.enqueueAsyncUploadRequest(u,[ba],{data:{original_fbid:x.fbid},indexMap:ca});i.photosSelect(u,1,r.METHOD_EDITOR);g.finishPhotoEdit(u);}};e.exports=t;},null);