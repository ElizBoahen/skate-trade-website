/*!CK:1759717168!*//*1436170725,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["mGZZD"]); }

__d("OGCollectionAddDialog",["AsyncRequest","DataStore","DOMQuery","Form","MenuDeprecated","URI","collectDataAttributes","csx","tidyEvent"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p='OGCollectionAddDialog';function q(r,s,t,u,v){this._dialog=r;this._surface=s;this._endpoint=new l(u);this._loadEditMenu=v.loadEditMenu;this._listener=h.get(String(t),p);this._audienceSelector=i.find(this._dialog.getContent(),'.audienceSelector');this._menu=i.find(this._dialog.getContent(),"._4-jt");k.register(this._menu);this._menuSubscriptionToken=k.subscribe('select',this._onMenuClick.bind(this));o([this._dialog.subscribe('show',this._onDialogShow.bind(this)),this._dialog.subscribe('hide',this._onDialogHide.bind(this))]);if(v.setContextToParent)this._dialog.setContext(this._dialog.getContext().parentNode);this._dialog.show();}Object.assign(q,{INSTANCE_KEY:p});Object.assign(q.prototype,{_onDialogShow:function(){this._listener.onDialogShow(this._dialog);},_onDialogHide:function(){this._destroy();},_onMenuClick:function(r,s){if(s.menu!==this._menu)return;var t=s.item;this._listener.onMenuClick(t);var u=i.find(t,"._5581"),v=u.getAttribute('value');this._submitRequest(v);},_submitRequest:function(r){this._endpoint.addQueryData({collection_token:r});this._dialog.hide();this._request=new g(this._endpoint).setData(Object.assign(j.serialize(this._audienceSelector),{action:'add',load_edit_menu:this._loadEditMenu,surface:this._surface},m(this._dialog.getContext(),['ft'])));this._request.send();},_destroy:function(){this._listener.onDialogHide();k.unsubscribe(this._menuSubscriptionToken);}});e.exports=q;},null);
__d("OGCollectionAddMenu",["CSS","DataStore","DOM","DOMQuery","Event","OGCollectionAddDialog","Parent","TidyArbiterMixin","csx","cx","tidyEvent"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();function r(s,t,u,v,w,x){this._image=t;this._container=u;this._placeholder=v;this._surface=w;this._rateControl=i.scry(this._container.parentNode,"._5fza")[0];r.inform('addButton',{button:this._image,root:this._container});q(k.listen(this._container,'click',function(y){var z=m.byClass(y.getTarget(),"_5859");if(this.isDialogShowing()&&z)y.kill();}.bind(this)));if(this._surface==='friend_timeline_lhc')this._handleAlwaysVisibleLHC();h.set(String(s),l.INSTANCE_KEY,this);}Object.assign(r,n);Object.assign(r.prototype,n,{destroy:function(){i.remove(this._container);this._placeholder.destroy();},hide:function(){g.hide(this._image);this._placeholder.hide();},getParent:function(){return this._container.parentNode;},insertMenuIntoDialog:function(s){this._placeholder.insertIntoDialog(s);},onMenuClick:function(s){var t=j.find(s,"._5582");this._showRate=this._rateControl&&t.getAttribute('value');if(this._showRate){this.switchToShowRate();k.fire(this._rateControl,'click');}else this._switchToShowPlaceholder();this.inform('menuclicked');},onDialogShow:function(s){var t=j.find(s.getContent(),'.audienceSelector');g.addClass(this._image,'openToggler');r.inform('menuOpened',{audienceSelector:t.parentNode});this._dialogShowing=true;},onDialogHide:function(){g.removeClass(this._image,'openToggler');this._dialogShowing=false;},isDialogShowing:function(){return this._dialogShowing;},_switchToShowPlaceholder:function(){g.hide(this._image);g.show(this._placeholder.getIcon());},switchToShowRate:function(){g.hide(this._image);g.show(this._rateControl);},_handleAlwaysVisibleLHC:function(){var s=m.byClass(this._container,"_4_ij"),t=m.byClass(s,"_5-r");if(g.hasClass(s,"_58v0"))q([this._alwaysVisibleToken=k.listen(t,'mouseenter',function(){g.removeClass(s,"_58v0");this._alwaysVisibleToken.remove();}.bind(this))]);}});e.exports=r;},null);
__d("OGCollectionAddedIconPlaceholder",["CSS","DataStore","DOM","DOMQuery","Event","csx","tidyEvent"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n='OGCollectionAddedIconPlaceholder';function o(p,q,r,s){this._dialog=r;this._icon=q;this._addPlaceholder=s;m(k.listen(q,'click',r.show.bind(r)));h.set(String(p),n,this);}Object.assign(o,{loadEditMenu:function(p,q){var r=h.get(String(p),n);r.insertIntoDialog(q);}});Object.assign(o.prototype,{destroy:function(){this._dialog.destroy();},getIcon:function(){return this._icon;},hide:function(){g.hide(this._icon);g.show(this._addPlaceholder);this._dialog.hide();},insertIntoDialog:function(p){i.setContent(j.find(this._dialog.getContent(),"._51rr"),p);}});e.exports=o;},null);
__d("OGCollectionAddedIconRate",["DataStore","Event","tidyEvent"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j='OGCollectionAddedIconRate';function k(l,m){this._link=l;g.set(String(m),j,this);}k.disable=function(l){var m=g.get(String(l),j);m._disable();};Object.assign(k.prototype,{_disable:function(){i(h.listen(this._link,'click',function(l){l.kill();}));}});e.exports=k;},null);